# Day5 动态规划
dp的常见用途，是在满足某种条件的限制之下，求解某问题的最优解（或方案数）。
##  一、状态与转移
    e.g.最长不上升子序列
### 状态
状态本质上是一类满足要求的情况的集合
### 状态的记录
（1）从转移出发记录

（2）从答案出发记录

（3）从题目限制出发

（4）尽量简化

### 状态的转移
我们用转移来实现状态的转化，可用状态转移方程的形式表达。

### 阶段
阶段是问题的一个部分，在不断扩大的过程中来解决问题全局。

## 二、dp问题的重要性质
    e.g.P2758
    考虑修改产生的结果：
    若a1 != b1：
    ① 修改，变为a(2-n)匹配b(1-m)，保证a1会与b1匹配；
    ② 删除a1，则变为a(2-n)匹配b(1-m)，但不保证a2与b1会匹配；
    ③ 插入；
    考虑同时要记录a，b两个字符串的当前匹配位置，
    我们设f[i][j]为A考虑到第i位，B考虑到第J位时（即A的[1,i]和B的[1,j]已经匹配）的最小操作次数，那么：
    if A[i]=B[J] then f[i][j]=min(f[i][j],f[i-1][j-1])


这类问题具有重叠子问题。这是我们设状态的一个切入点，具有比较明显的重复性

    e.g.2 P4042
    这种题有体力消耗的计算，所以显然是不能贪心的；
    同时这个题并不能确定一个状态的转移顺序
    考虑放在图中理解；将每个状态看作是一个点，若A状态能转移到B状态，那么连一条A向B的权值是这次
    转移对答案的贡献的有向边
    有明确转移顺序的dp可以建成一个DAG，若是没有则是一个有向有环图，可用SPFA来解决。

    e.g.3 P4342(简化)
    给定一个长度为n的运算序列a（如3+5*4），但是运算顺序不是先乘后加，而是从左
    至右（如3+5*4=32）.你可以给这个序列加括号改变运算顺序（如3+(5*4)=23），你可以任意的加括号
    （即任意钦定运算符的运算顺序），求最后的运算结果最大是多少。
    n<=200，a[i]可以是负数。
    （原版是环上问题，由于断环为链的技巧不在我们今天的讨论范围之内，故修改）
    注意负负得正，所以这个问题不满足最优子结构。可以用SPFA或者进行一些trick的优化。

    e.g.4 CF626F(简化)
    给定一个长度为n的序列a，你需要把它划分成若干个子序列（可以不连续，可以长度为1，
    但原顺序不能变），每个子序列的价值为结尾元素减起始元素，使所有子序列的价值和最大。
    n<=200
    考虑从左向右扫这个序列，每个位置可以新开一个子序列做开头、加入已有的子序
    列做中间值、加入已有的子序列做结尾。
    观察发现：对于不同的子序列，中间值是什么我们是不需要管的，而对答案产生影响的是
    起始元素当时放的是什么。
    但是，把当时开头放了什么记入状态，显然是不现实的。而直接设f[i][j]表示当前在
    第i位，目前有j个子序列已开启未闭合，又会因为信息不全而无法统计答案。
    所以影响转移的信息无法全部记到状态里，即转移受到了状态之外的信息所影响，也即不
    满足无后效性。
    有后效性怎么办？
    1.把影响转移的部分加到状态里，增多状态，细化方案的分类。
    2.费用提前计算。（本题方法，可以很难）
    3.重设状态，改换思路。
## 三、dp的正确性检验
基本原则：

1.有合适的初值，且根据初值可以求出答案；

2.根据初值可以推出正确的终值

对于检验转移是否正确我们有一个类似于数学归纳法的思想：

假设某一阶段以前的信息都已经正确得到，通过转移方程，我们可以得到下一阶段的正确信息，那么所设计的动态规划就是正确的。

## 四、填表法和刷表法
填表法：先枚举目前要求信息的状态，再枚举哪些状态能转移到它。

刷表法：先枚举已知信息的状态，再枚举它能转移到的状态。
## 五、Dp时间复杂度的优化
时间复杂度=预处理复杂度+状态复杂度×转移复杂度。

空间复杂度<=状态复杂度（比如滚动数组）。

时空复杂度是检验dp优劣的重要标准，一切对于动态规划的优化都是针对复杂度的优化。

    e.g.1 有一条长度为L的河，有n个地方有石子a1-an，青蛙要从河的一侧跳到另一侧，且青蛙必须落到石子上。
    青蛙有两种跳法：
    · 跳m_a米，这种调法最多跳x_a次，每次花费c_a的体力；
    · 跳m_b米，最多跳x_b次，每次花费c_b的体力
    （青蛙只能向一个方向跳，保证有解）
    求跳到另一测的最小体力花费

    e.g.2 洛谷某题
    轮胎肯定要记录，因为不同轮胎在不同圈的圈速不同