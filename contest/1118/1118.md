# 二进制加法

## 题目内容

intlsy 手上有一个位数为 $N$ 的二进制数字 $X$，初始情况下 $X = a_0$。

intlsy 会依次进行 $M$ 次操作，第 $i$ 次操作时 intlsy 会令 $X\ {\small\text{+=}}\  2^{k_i}$。现在 intlsy 关心两个问题：

1. 每一次操作中，$X$ 中有多少个位 (bit) 发生了变化？

2. 在进行完这 $M$ 次操作后，$X$ 的值为多少？



## 输入格式

输入一共有 $M+3$ 行。

第一行有一个正整数 $N\ (1 \le N \le 10^5)$，表示初始状态下 $X$ 的位数。

第二行是一个长度为 $N$ 的 01 串，表示初始状态下 $X$ 的值 $a_0$。保证没有前导零。

第三行是一个正整数 $M\ (1 \le M \le 2 \times 10^5)$，表示 intlsy 想要进行的操作的数量。

随后有 $M$ 行，每行一个正整数，代表每一次操作中的 $k_i\ (0 \le k_i \le N-1)$。



## 输出格式

输出一共有 $M+1$ 行。

首先请输出 $M$ 行，每行一个正整数，代表第 $i$ 次操作中，$X$ 有多少个位发生了变化。

最后一行请输出一个 01 串，代表经过了所有操作后的 $X$ 的值。请不要输出前导零。



## 输入输出样例

### 样例 1 输入

```
3
110
6
2
2
1
2
2
2
```

### 样例 1 输出

```
2
1
4
1
2
1
11100
```



### 样例2 输入

```
16
1111101111010011
15
12
14
13
4
9
15
13
15
7
12
14
15
8
15
13
```

### 样例2 输出

```
5
1
1
2
2
1
5
1
3
1
1
2
1
1
1
111111111101100011
```



## 数据范围与提示

在第一组样例中，$X$ 的值经历了如下变化（二进制）：

$110 \to 1010 \to 1110 \to 10000 \to 10100 \to 11000 \to 11100$

对于 $20\%$ 的数据，有 $N \le 10, M \le 100$。

对于 $40\%$ 的数据，有 $N \le 1000, M \le 2000$。

对于 $100\%$ 的数据，数据范围见题面。



# 最大权子序列

## 题目内容

intlsy 有一个序列 $a_1, a_2, \dots, a_n$。

对于一个序列 $b_1, b_2, \dots, b_m$，定义它的权值为 $\sum_{i=1}^{m-1} \max(b_i, b_{i+1})$。

比如，序列 $[1, -2, -3, 4]$ 的权值为 $\max(1, -2) + \max(-2, -3) + \max(-3, 4) = 1 + (-2) + 4$。

现在 intlsy 想从 $a_1 \dots a_n$ 的所有子序列中选出权值最大的那个。请你选择一个子序列使其权值最大。请输出对应的权值与对应的子序列。若多个子序列均具有最大的权值，输出任意一个即可。

注：空子序列也算作子序列。我们定义空子序列的权值为 $0$。长度为 1 的子序列权值为 $0$。



## 输入格式

输入一共有两行。

第一行为数字 $N\ (1 \le N \le 2 \times10^5)$，代表序列 $a$ 的长度。

第二行有 $N$ 个数字 $a_1, a_2, \dots, a_n\ (-2 \times 10^5 \le a_i \le 2 \times 10^5)$，代表序列 $a$。



## 输出格式

输出一共有三行。

第一行请输出一个数字 $V$，代表权值最大的子序列的权值。

第二行请输出一个数字 $M$，代表你选择的子序列的长度。

第三行请输出 $M$ 个数字，代表你选择的子序列。



## 输入输出样例

### 样例 1 输入

```
8
1 7 -9 -8 -5 10 -4 8
```

### 样例 1 输出

```
42
6
1 7 -5 10 -4 8
```



### 样例2 输入

```
7
2 9 -8 -5 5 9 -9 
```

### 样例2 输出

```
41
6
2 9 -5 5 9 -9
```



## 数据范围与提示

对于 $20\%$ 的数据，有 $n \le 10, a_i \le 1000$，

对于 $50\%$ 的数据，有 $n \le 2000, a_i \le 2000$，

对于另外 $10\%$ 的数据，有 $a_i \ge 0$，

对于 $100\%$ 的数据，数据范围见题面。

本题有 SPJ，你的输出不一定要和数据完全相同，只要你输出的子序列对应的权值为最大权值即可。

温馨提示：$2 \times 10^5 \times 10^5 > 2^{31}-1$。



# 开挂的定向越野

## 题目背景

intlsy 喜欢玩定向越野。

<img src="https://noip.ac/api/imagestore/get?file_id=65c51ac1-eb73-4a09-92ae-312f84a223b3" style="width: 70%"> </img>

图片版权：北京大学定向运动协会。

注：图片与题意无关。



## 题目内容

本次定向越野的地图可以抽象为一张 $N$ 个点 $M$ 条边的带权有向图。

现在，intlsy 位于点 $1$，他的目标是通过若干次移动，到达点 $N$。

每次移动时，intlsy 可以选择一条从他当前所在节点出发的边，并花费 $c$ 秒（$c$ 为边权），走到这条边所指向的点。

现在 intlsy 想让你帮他算算，如果他想从 $1$ 号点走到 $N$ 号点，最少花费多少秒？

（如果题面到此为止，那么这题就是一个简单的“给定一张有向图，请问从 $1$ 到 $N$ 的最短路长度是多少”的单源最短路问题，可惜止不得）

并且，由于 intlsy 发现他落后于其他选手太多了，所以他决定开飞行外挂。但他不能乱开挂（否则会被 ban）。具体的，开挂的规则如下：

- 每个节点都有三个参数：$a_i, b_i$ 和 $c_i$。
- 假设 intlsy 现在位于 $i$ 点，那么对于某个点 $j$，如果 $a_i \oplus a_j \ge b_i$，那么他可以花费 $c_i+c_j$ 秒，从点 $i$ 飞到点 $j$；而如果 $a_i \oplus a_j < b_i$，他就不能这样飞。这里的「$\oplus$」代表异或运算，即 C++ 中的 `^`。
- intlsy 可以开挂无限次。

现在 intlsy 想让你帮他算算，如果他想从 $1$ 号点出发，到达 $N$ 号点，最少花费多少秒？

如果无法从点 $1$ 到达点 $N$，请输出 $-1$。



## 输入格式

第一行两个数字 $N\ (1 \le N \le 100000)$ 和 $M\ (1 \le M \le 200000)$，分别代表地图中的节点数和边数。

接下来有 $N$ 行，每行三个数，分别代表每个节点的 $a_i, b_i$ 和 $c_i$$\ (0 \le a_i, b_i, c_i \le 10^6)$。

接下来有 $M$ 行，每行三个数 $u, v, c$，代表地图中有一条 $u$ 到 $v$ 的权值为 $c$ 的有向边 $1 \le u, v \le N,\ 1 \le c \le 10^6$。这部分数据保证没有重边或自环。



## 输出格式

请输出一个数字，代表从 $1$ 出发，到达 $N$ 点，最少需要多少秒。



## 输入输出样例

### 样例 1 输入

```
6 8
20 2 6
3 4 18
8 4 17
2 4 8
15 4 11
20 4 5
2 5 10
6 4 9
3 2 7
5 4 18
4 3 11
5 6 7
1 2 6
3 4 6
```

### 样例 1 输出

```
23
```



### 样例2 输入

```
22 25
11 16 12
0 6 14
15 17 14
5 17 13
11 11 16
10 12 10
11 15 11
11 11 10
11 13 12
8 14 10
11 9 13
6 12 17
12 8 15
8 13 11
15 16 11
2 7 13
6 14 19
3 17 12
11 15 14
3 17 10
8 16 14
14 6 12
10 2 10
15 14 18
1 10 21
20 3 25
9 10 20
1 21 12
3 2 20
16 3 26
4 22 10
2 11 14
14 21 25
11 1 30
10 18 12
1 20 28
1 3 30
14 3 16
21 8 28
6 8 14
5 2 28
22 1 19
1 5 11
20 21 11
19 13 26
5 14 12
2 10 27
```

### 样例2 输出

```
50
```





## 数据范围与提示

### 样例解释

对于样例1，路线为1 -> 2 -> 5 -> 6；

对于样例2，路线为：1 -> 5 => 4 -> 22（-> 代表走，=> 代表飞）；

对于样例3（见 cheat03.in），路线为：1 -> 22117 => 56663 => 27532 -> 34749 -> 58057

### 数据范围

对于 $10\%$ 的数据，$1 \le N \le 10,\ 1 \le M \le 20$。

对于 $30\%$ 的数据，$1 \le N \le 1000,\ 1 \le M \le 2000$。

对于另外 $30\%$ 的数据，所有的 $b_i$ 均为 $0$。

对于 $100\%$ 的数据，数据范围见题面。

本题默认开启 O2 优化。



# 网格上的收费站

## 题目内容

intlsy 正站在一张网格图上。这个网格图一共有 $n$ 行 $m$ 列。我们约定坐标 $(r, c)$ 表示第 $r$ 行第 $c$ 列的格子。现在 intlsy 位于 $(1, 1)$，他的目标是到达 $(n, 
m)$。

intlsy 将从所有从 $(1, 1)$ 到 $(n, m)$ 的最短路中等概率随机选择一条路径，并按这条路径从起点走到终点。

刚开始，intlsy 的口袋中有 $a_0$ 元钱。网格图上有 $k$ 个收费站，它们分别位于 $(x_1, y_1), (x_2, y_2) \dots (x_k, y_k)$。每次经过一个收费站时，收费站会从 intlsy 身上收走一块钱，除非他此时已经没有钱了。（注，保证 $(1, 1)$ 和 $(n, m)$ 两个点没有收费站，保证任意两个收费站的坐标不一样。）

形式化地，如果在经过收费站前 intlsy 有 $X$ 元钱，那么经过收费站后，intlsy 就会剩下 $\max(X-1, 0)$ 元钱。

当 intlsy 到达 $(n, m)$ 后，假设他手上还有 $X$ 元，那么它可以获得 $X^4 + 3X^3 + 5^X + 6X + 233$ 点积分。

现在 intlsy 想让你算算，如果他从所有从 $(1, 1)$ 到 $(n, m)$ 的最短路中等概率随机选择一条路径，最后他获得的积分的期望是多少？请输出答案 $\bmod (10^9+7)$ 的值。



## 输入格式

输入一共包含 $k+1$ 行。

第一行有四个数，$n, m, k, a_0\ (1 \le n \le 100000, 1 \le m \le 100000, 1 \le k \le 500, 1 \le a_0 \le 500)$

随后 $k$ 行，每行有两个数 $x_i, y_i$，代表第 $i$ 个收费站的坐标。保证坐标不会重复。保证坐标不会等于 $(1, 1)$ 或 $(n, m)$。保证坐标位于 $n \times m$ 的网格内。



## 输出格式

请输出一个数，代表 intlsy 获得的积分的期望 $\bmod (10^9+7)$ 的值。



## 输入输出样例

### 样例 1 输入

```
5 3 3 4
2 3
4 1
2 1
```

### 样例 1 输出

```
200000637
```



### 样例2 输入

```
3 3 2 3
1 3
2 3
```

### 样例2 输出

```
666667085
```



### 样例3 输入

```
8 5 10 11
4 2
5 4
7 5
7 2
1 3
6 3
7 4
8 3
1 5
1 2
```

### 样例3 输出

```
643459880
```



## 数据范围与提示

### 样例说明

在样例 1 中，在所有从 $(1,1)$ 到 $(n,m)$ 的路径中，途径 0 个收费站的有 3 条，途径 1 个收费站的有 8 条，2 个收费站的有 4 条，3 个及以上的有 0 条。

途径 0 个收费站时，intlsy 身上还有 4 块，获得积分 1330。

途径 1 个收费站时，intlsy 身上还有 3 块，获得积分 538。

途径 2 个收费站时，intlsy 身上还有 2 块，获得积分 310。

所以最后的期望 $= \frac{3}{15} \times 1330 + \frac{8}{15} \times 538 + \frac{4}{15} \times 310 = \frac{9534}{15}$。在 $\bmod 10^9+7$ 的意义下为 $200000637$。

在样例 2 中，途径 0 个收费站的路径有 3 条，1 个收费站的有 2 条，2 个收费站的有 1 条。

在样例 3 中，途径 0 个收费站的有 0 条，1 个收费站的有 13 条，2 个的有 78 条，3 个的有 137 条，4 个的有 85 条，5 个的有 17 条，6 个及以上的有 0 条。

### 数据范围

对于 $10\%$ 的数据，有 $n, m, k \le 5$。

对于 $20\%$ 的数据，有 $n, m, k \le 15$。

对于 $40\%$ 的数据，有 $n, m \le 250$。

对于另外 $20\%$ 的数据，有 $a_0 = 1$。

对于 $100\%$ 的数据，$1 \le n \le 100000, 1 \le m \le 100000, 1 \le k \le 500, 1 \le a_0 \le 500$。

建议选手开启 O2 优化。