## A（1s,512MB）

### 题目描述

有一个 $n \times n$ 的三角形，三角形有 $n$ 行，第 $i$ 行有 $i$ 个格点，我们用坐标 $(i,j)$ 表示一个格点。

接下来 $q$ 轮，第 $i$ 轮会有一个重量为 $v_i$ 的小球从格点 $(1,1)$ 处滚落。

对于前 $n-1$ 行的所有格点 $(i,j)$，这些点都有一个权值 $w_{i,j}$，表示如果有一个重量为 $x$ 的球滚到了这个点，那么如果 $x \le w_{i,j}$ 那么他会滚到点 $(i+1,j)$，否则会滚到 $(i+1,j+1)$。当一个小球滚到第 $n$ 行后就会掉出三角形。

请对每个格点求出 $q$ 轮之后，有多少小球曾经经过这个格点。

### 输入格式

第一行两个整数 $n,q$。

接下来 $n-1$ 行，第 $i$ 行输入 $i$ 个整数，其中第 $j$ 个表示 $w_{i,j}$。

接下来一行 $q$ 个整数表示每个小球的重量 $v_i$。

### 输出格式

输出 $n$ 行，第 $i$ 行 $i$ 个整数，其中第 $j$ 个表示 $(i,j)$ 的经过次数。

### 样例 1

#### input

```
5 6
1 
4 2 
1 3 10 
5 8 8 4 
1 5 5 5 8 2 
```

#### output

```
6 
1 5 
1 1 4 
1 1 4 0 
1 1 4 0 0 
```

### 样例 2

见下发文件

### 数据范围

对于 $30\%$ 的数据，满足 $q \le 5000$。

对于另外 $20\%$ 的数据，满足 $v_i,w_{i,j} \le 20$。

对于全部数据，满足 $n \le 1000$，$q \le 10^6$，$v_i,w_{i,j} \le 10^6$。

## B（1s,512MB）

Alice 和 Bob 正在一个二维平面上玩游戏，起初他们都位于 $(0,0)$，Alice 想去 $(n,a_y)$，而 Bob 想去 $(n,b_y)$。

每一个时刻，Alice 和 Bob 同时移动，他们遵循共同的移动规则：假如此时位于 $(x,y)$，那么下一个时刻可以选择位于 $(x+1,y-1)$ 或 $(x+1,y+1)$。

由于 Alice 和 Bob 的关系很不好，所以他们不想在除了起点以外的任何点相遇。

请你求出有多少种合法的方案对 $998244353$ 取模的结果。

两个方案不同当且仅当 Alice 经过的路径不同或 Bob 经过的路径不同。

### 输入格式

本题有多组数据，第一行输入一个整数 $T$ 表示数据组数。

对于每组数据，输入一行四个整数分别表示 $n,a_y,b_y$。

### 输出格式

对于每组数据输出一行表示答案。

### 样例 1

#### input

```
5
5 5 3
5 -5 3
2 0 2
2 2 2
5 -1 3
```

#### output

```
1
4
1
0
20
```

### 样例 2

见下发文件。

### 数据范围

对于 $20\%$ 的数据，满足 $n \le 10$。

对于 $40\%$ 的数据，满足 $n \le 300$。

对于 $70\%$ 的数据，满足 $n \le 2000$。

对于 $100\%$ 的数据，满足 $1 \le n \le 2 \times 10^5$，$|a_y|,|b_y| \le 10^9$，$a_y\not=b_y$，$T \le 5$。

## C（2s,512MB）

给定一个 $n$ 个点 $m$ 条边的有向图，你可以翻转一些边，求出所有 $2^m$ 种翻转方案中，翻转后得到的图为一个有向无环图的方案的反转边数的和。答案对 $998244353$ 取模。

### 输入格式

第一行两个整数表示 $n,m$。

接下来 $m$ 行，每行两个整数 $u,v$ 表示一条有向边。

### 输出格式

输出一个数表示答案。

### 样例 1

#### input

```
3 3
2 3
2 1
3 1
```

#### output

```
9
```

### 样例 2

见下发文件。

### 数据范围

共 $10$ 个测试点，每个测试点 $n$ 的大小分别为：

$4,5,7,10,12,14,16,17,17,17$。

对于全部数据，满足 $3 \le n \le 17$，$m \le \frac{n(n-1)}{2}$，保证把输入的边看成无向边后无重边自环。

## D（2s,512MB）

给定 $nm$ 个有序的数 $a_1,a_2,\cdots,a_{nm}$，将这些数分成若干无序的组使得每组大小为 $m$ 的倍数，每个数都在且仅在一个组 $G$ 内。

定义一个合法的分组方案 $P$ 的权值为 $\prod\limits_{G \in P}\sum\limits_{x \in G}a_{x}$。

求所有分组方案的权值和对 $10^9+7$ 取模的结果。

### 输入格式

第一行两个整数 $n,m$。

第二行 $nm$ 个整数依次表示序列 $a_i$。

### 输出格式

一行一个整数表示所有方案权值的总和。

### 样例一

#### input

```plain
3 1
3 3 9 
```

#### output

```plain
222
```

### 样例二

#### input

```plain
2 2
10 6 7 5 
```

#### output

```plain
602
```

### 样例 3

见下发文件。

### 限制与约定

对于 $10\%$ 的数据，满足 $n,m \le 4$。

对于 $25\%$ 的数据，满足 $n \le 100$。

对于 $40\%$ 的数据，满足 $n \le 500$。

对于另外 $20\%$ 的数据，满足 $m=1$。

对于所有数据满足： $1 \le n \le 1500$，$1 \le m \le 100$，$0 \le a_i < 10^9+7$。
